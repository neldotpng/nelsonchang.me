{"ast":null,"code":"import _classCallCheck from \"/Users/Nelson/GitHub/nelsonchang.me/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/Nelson/GitHub/nelsonchang.me/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/Nelson/GitHub/nelsonchang.me/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/Nelson/GitHub/nelsonchang.me/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/Nelson/GitHub/nelsonchang.me/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/Nelson/GitHub/nelsonchang.me/src/components/TextCanvas.js\";\nimport React, { Component } from 'react';\nimport { TweenMax, Sine } from 'gsap';\nimport Particle from './Particle';\nimport debounce from '../functions/debounce';\nimport { isMobileDevice } from '../functions/browser-detect';\n\nvar TextCanvas =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TextCanvas, _Component);\n\n  function TextCanvas() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TextCanvas);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TextCanvas)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      isMobile: isMobileDevice(),\n      width: window.innerWidth,\n      height: window.innerHeight,\n      dpi: 2,\n      words: ['장수영', '나는', '베라이존', '트라이넷', '카르티에', '마르케', '오디세이', '이것저것', '다음'],\n      size: {\n        max: 25,\n        grid: 23,\n        min: 21\n      },\n      fontSize: '140vh',\n      fontFamily: 'Black Han Sans',\n      i: 0,\n      vertical: false,\n      timer: null,\n      wordTimer: null\n    };\n\n    _this.init = function () {\n      _this.canvas = document.getElementById('canvas');\n      _this.ctx = _this.canvas.getContext('2d');\n      _this.txtCanv = document.createElement('canvas');\n      _this.txtCtx = _this.txtCanv.getContext('2d');\n      _this.txtCtx.fillStyle = 'black';\n    };\n\n    _this.setValues = function () {\n      _this.canvas.width = _this.state.width * _this.state.dpi;\n      _this.canvas.height = _this.state.height * _this.state.dpi;\n      _this.particles = [];\n      _this.txtCanv.width = _this.canvas.width;\n      _this.txtCanv.height = _this.canvas.height;\n      _this.txtCtx.textBaseline = 'middle';\n      _this.txtCtx.font = \"\".concat(_this.state.fontSize, \" \").concat(_this.state.fontFamily);\n\n      if (!_this.state.vertical) {\n        _this.getPixels(_this.state.words[_this.state.i]);\n      } else {\n        _this.getPixelsV(_this.state.words[_this.state.i]);\n      }\n\n      _this.makeParticles();\n\n      _this.animate();\n    };\n\n    _this.makeParticles = function () {\n      for (var i = 0; i < _this.positions.length; i++) {\n        if (!!_this.positions[i]) {\n          _this.particles.push(new Particle(_this.state.width, Math.pow(i, 1.3) * Math.sin(i), _this.positions[i].x, _this.positions[i].y, _this.ctx, _this.state.size.min));\n        }\n      }\n    };\n\n    _this.addParticles = function () {\n      var nta = _this.positions.length - _this.particles.length;\n\n      for (var i = 0; i <= nta; i++) {\n        _this.particles.push(new Particle(_this.canvas.width / 2, i + _this.canvas.height / 2, _this.canvas.width / 2, i + _this.canvas.height / 2, _this.ctx, _this.state.size.min));\n      }\n    };\n\n    _this.removeParticles = function () {\n      var newArr = _this.particles.slice(0, _this.positions.length);\n\n      _this.particles = newArr;\n    };\n\n    _this.getPixels = function (keyword) {\n      _this.txtCtx.clearRect(0, 0, _this.txtCanv.width, _this.txtCanv.height);\n\n      _this.txtCtx.fillText(keyword, _this.txtCanv.width / 2 - _this.txtCtx.measureText(keyword).width / 2, _this.txtCanv.height / 2);\n\n      var imgData = _this.txtCtx.getImageData(0, 0, _this.txtCanv.width, _this.txtCanv.height);\n\n      var buffer32 = new Uint32Array(imgData.data.buffer);\n      _this.positions = [];\n\n      for (var y = 0; y < _this.txtCanv.height; y += _this.state.size.grid) {\n        for (var x = 0; x < _this.txtCanv.width; x += _this.state.size.grid) {\n          if (buffer32[y * _this.txtCanv.width + x]) {\n            _this.positions.push({\n              x: x,\n              y: y\n            });\n          }\n        }\n      }\n\n      var diff = (_this.canvas.height - _this.positions[_this.positions.length - 1].y - _this.positions[0].y) / 2;\n\n      _this.positions.forEach(function (p) {\n        p.y += diff;\n      });\n    };\n\n    _this.getPixelsV = function (keyword) {\n      _this.txtCtx.clearRect(0, 0, _this.txtCanv.width, _this.txtCanv.height);\n\n      _this.txtCtx.textBaseline = 'top';\n      var p;\n\n      if (keyword.length >= 3) {\n        _this.setState({\n          fontSize: \"\".concat(110 / keyword.length * _this.state.dpi, \"vh\")\n        }, function () {\n          _this.txtCtx.font = \"\".concat(_this.state.fontSize, \" \").concat(_this.state.fontFamily);\n        });\n\n        p = 1 / keyword.length;\n      } else {\n        _this.setState({\n          fontSize: \"\".concat(80 / keyword.length * _this.state.dpi, \"vh\")\n        }, function () {\n          _this.txtCtx.font = \"\".concat(_this.state.fontSize, \" \").concat(_this.state.fontFamily);\n        });\n\n        p = 0.4;\n      }\n\n      for (var i = 0; i < keyword.length; i++) {\n        _this.txtCtx.fillText(keyword[i], i * (_this.txtCanv.width / ((keyword.length + 1) / 2) - _this.txtCtx.measureText(keyword[i]).width / 2), i * (_this.txtCanv.height * p));\n      }\n\n      var imgData = _this.txtCtx.getImageData(0, 0, _this.txtCanv.width, _this.txtCanv.height);\n\n      var buffer32 = new Uint32Array(imgData.data.buffer);\n      _this.positions = [];\n\n      for (var y = 0; y < _this.txtCanv.height; y += _this.state.size.grid) {\n        for (var x = 0; x < _this.txtCanv.width; x += _this.state.size.grid) {\n          if (buffer32[y * _this.txtCanv.width + x]) {\n            _this.positions.push({\n              x: x,\n              y: y\n            });\n          }\n        }\n      }\n\n      var diff;\n\n      if (keyword.length >= 3) {\n        diff = _this.positions[0].y / -1;\n      } else {\n        diff = (_this.canvas.height - _this.positions[_this.positions.length - 1].y - _this.positions[0].y) / 2;\n      }\n\n      _this.positions.forEach(function (p) {\n        p.y += diff;\n      });\n    };\n\n    _this.animateParticles = function () {\n      _this.positions.forEach(function (p, i) {\n        _this.particles[i].move(_this.mx, _this.my);\n\n        _this.particles[i].draw();\n      });\n    };\n\n    _this.changeWord = function () {\n      TweenMax.killAll(true);\n\n      if (!_this.state.vertical) {\n        _this.getPixels(_this.state.words[_this.state.i]);\n      } else {\n        _this.getPixelsV(_this.state.words[_this.state.i]);\n      }\n\n      if (_this.positions.length > _this.particles.length) {\n        _this.addParticles();\n      } else {\n        _this.removeParticles();\n      }\n\n      _this.positions.forEach(function (p, i) {\n        _this.particles[i].homeX = p.x;\n        _this.particles[i].homeY = p.y;\n      });\n\n      _this.setState({\n        wordTimer: setTimeout(_this.tweenSize, 2000)\n      }); // this.tweenSize();\n\n    };\n\n    _this.animate = debounce(function () {\n      _this.ctx.clearRect(0, 0, _this.canvas.width, _this.canvas.height);\n\n      _this.animateParticles();\n\n      _this.animation = requestAnimationFrame(_this.animate);\n    }, 1000 / 60);\n\n    _this.tweenSize = function () {\n      if (_this.state.isMobile) return;\n      var t = 3.5,\n          l = _this.particles.length;\n\n      _this.particles.forEach(function (p, i) {\n        TweenMax.to(p, t, {\n          radius: _this.state.size.max,\n          homeX: !_this.state.isMobile ? p.getX() + 20 : p.getX() + 10,\n          homeY: !_this.state.isMobile ? p.getY() + 30 : p.getY() + 15,\n          delay: t / l * i,\n          yoyo: true,\n          repeat: -1,\n          easing: Sine.easeInOut\n        });\n      });\n    };\n\n    _this.resetTween = function () {\n      _this.setValues();\n\n      TweenMax.killAll(true);\n\n      _this.tweenSize();\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.mx = (e.clientX - _this.canvas.offsetLeft) * _this.state.dpi;\n      _this.my = (e.clientY - _this.canvas.offsetTop) * _this.state.dpi;\n    };\n\n    _this.onResize = function () {\n      if (_this.state.width !== window.innerWidth || _this.state.height !== window.innerHeight && _this.state.width > 768) {\n        _this.setCanvasState();\n      }\n    };\n\n    _this.setCanvasState = function () {\n      _this.setState({\n        width: window.innerWidth,\n        height: window.innerHeight\n      }, function () {\n        if (_this.state.width >= 1600) {\n          _this.setState({\n            size: {\n              max: 14.5 * _this.state.dpi,\n              grid: 14 * _this.state.dpi,\n              min: 13.5 * _this.state.dpi\n            },\n            fontSize: \"\".concat(70 * _this.state.dpi, \"vh\"),\n            vertical: false\n          }, _this.setValues);\n        } else if (_this.state.width < 1600 && _this.state.width >= 1080) {\n          _this.setState({\n            size: {\n              max: 12 * _this.state.dpi,\n              grid: 11.5 * _this.state.dpi,\n              min: 11 * _this.state.dpi\n            },\n            fontSize: \"\".concat(65 * _this.state.dpi, \"vh\"),\n            vertical: false\n          }, _this.setValues);\n        } else if (_this.state.width < 1080 && _this.state.width >= 768) {\n          _this.setState({\n            size: {\n              max: 9.5 * _this.state.dpi,\n              grid: 9 * _this.state.dpi,\n              min: 8.5 * _this.state.dpi\n            },\n            fontSize: \"\".concat(60 * _this.state.dpi, \"vh\"),\n            vertical: false\n          }, _this.setValues);\n        } else if (_this.state.width < 768 && _this.state.width >= 480) {\n          _this.setState({\n            size: {\n              max: 7.5 * _this.state.dpi,\n              grid: 7 * _this.state.dpi,\n              min: 6.5 * _this.state.dpi\n            },\n            fontSize: \"\".concat(60 * _this.state.dpi, \"vh\"),\n            vertical: false\n          }, _this.setValues);\n        } else {\n          _this.setState({\n            size: {\n              max: 7.5 * _this.state.dpi,\n              grid: 7 * _this.state.dpi,\n              min: 6.5 * _this.state.dpi\n            },\n            fontSize: \"\".concat(40 * _this.state.dpi, \"vh\"),\n            vertical: true\n          }, _this.setValues);\n        }\n      });\n    };\n\n    _this.onScroll = function () {\n      TweenMax.killAll(true);\n\n      _this.props.setHasBackground(true);\n\n      clearTimeout(_this.state.wordTimer);\n      clearTimeout(_this.state.timer);\n\n      _this.setState({\n        timer: setTimeout(function () {\n          _this.props.setHasBackground(false);\n\n          _this.tweenSize();\n        }, 5000)\n      });\n    };\n\n    _this.onScrollToBottom = function () {\n      _this.updateWord(6, 0);\n    };\n\n    _this.onScrollUp = function () {\n      _this.updateCanvas(_this.props.location, 0);\n    };\n\n    _this.initWord = function () {\n      switch (_this.props.location) {\n        default:\n        case '/':\n          _this.setState({\n            i: 0\n          });\n\n          break;\n\n        case '/about':\n          _this.setState({\n            i: 1\n          });\n\n          break;\n\n        case '/verizon':\n          _this.setState({\n            i: 2\n          });\n\n          break;\n\n        case 'trinet':\n          _this.setState({\n            i: 3\n          });\n\n          break;\n\n        case 'cartier':\n          _this.setState({\n            i: 4\n          });\n\n          break;\n\n        case '/marquee-sports':\n          _this.setState({\n            i: 5\n          });\n\n          break;\n\n        case '/odyssey':\n          _this.setState({\n            i: 6\n          });\n\n          break;\n\n        case '/etc':\n          _this.setState({\n            i: 7\n          });\n\n          break;\n      }\n    };\n\n    _this.updateWord = function (i, t) {\n      _this.setState({\n        i: i\n      }, function () {\n        _this.props.getBgText(_this.state.words[_this.state.i]);\n\n        setTimeout(function () {\n          _this.changeWord();\n        }, t);\n      });\n    };\n\n    _this.updateCanvas = function (location, t) {\n      switch (location) {\n        default:\n        case '/':\n          _this.updateWord(0, t);\n\n          break;\n\n        case '/about':\n          _this.updateWord(1, t);\n\n          break;\n\n        case '/verizon':\n          _this.updateWord(2, t);\n\n          break;\n\n        case 'trinet':\n          _this.updateWord(3, t);\n\n          break;\n\n        case 'cartier':\n          _this.updateWord(4, t);\n\n          break;\n\n        case '/marquee-sports':\n          _this.updateWord(5, t);\n\n          break;\n\n        case '/odyssey':\n          _this.updateWord(6, t);\n\n          break;\n\n        case '/etc':\n          _this.updateWord(7, t);\n\n          break;\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(TextCanvas, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.location !== this.props.location) {\n        this.updateCanvas(this.props.location, 250);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.init();\n      this.initWord();\n      setTimeout(function () {\n        _this2.updateCanvas(_this2.props.location);\n\n        _this2.setCanvasState();\n      }, 1500);\n      window.addEventListener('resize', debounce(this.onResize, 1000 / 5));\n\n      if (!this.state.isMobile) {\n        window.addEventListener('mousemove', this.onMouseMove);\n        window.addEventListener('scroll', debounce(this.onScroll, 1000 / 45));\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"canvas\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 468\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          fontFamily: 'Black Han Sans',\n          fontSize: '1px',\n          color: '#EFEFEF'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 469\n        },\n        __self: this\n      }, \"\\uC7A5\\uC218\\uC601 \\uB098\\uB294 \\uB9C8\\uB974\\uCF00 \\uC624\\uB514\\uC138\\uC774 \\uD2B8\\uB801\\uD06C \\uC774\\uAC83\\uC800\\uAC83 \\uB2E4\\uC74C\"), React.createElement(\"canvas\", {\n        id: \"canvas\",\n        className: \"shared__canvas\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 477\n        },\n        __self: this\n      }, this.state.words[this.state.i]));\n    }\n  }]);\n\n  return TextCanvas;\n}(Component);\n\nexport default TextCanvas;","map":{"version":3,"sources":["/Users/Nelson/GitHub/nelsonchang.me/src/components/TextCanvas.js"],"names":["React","Component","TweenMax","Sine","Particle","debounce","isMobileDevice","TextCanvas","state","isMobile","width","window","innerWidth","height","innerHeight","dpi","words","size","max","grid","min","fontSize","fontFamily","i","vertical","timer","wordTimer","init","canvas","document","getElementById","ctx","getContext","txtCanv","createElement","txtCtx","fillStyle","setValues","particles","textBaseline","font","getPixels","getPixelsV","makeParticles","animate","positions","length","push","Math","pow","sin","x","y","addParticles","nta","removeParticles","newArr","slice","keyword","clearRect","fillText","measureText","imgData","getImageData","buffer32","Uint32Array","data","buffer","diff","forEach","p","setState","animateParticles","move","mx","my","draw","changeWord","killAll","homeX","homeY","setTimeout","tweenSize","animation","requestAnimationFrame","t","l","to","radius","getX","getY","delay","yoyo","repeat","easing","easeInOut","resetTween","onMouseMove","e","clientX","offsetLeft","clientY","offsetTop","onResize","setCanvasState","onScroll","props","setHasBackground","clearTimeout","onScrollToBottom","updateWord","onScrollUp","updateCanvas","location","initWord","getBgText","prevProps","addEventListener","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { TweenMax, Sine } from 'gsap';\n\nimport Particle from './Particle';\nimport debounce from '../functions/debounce';\nimport { isMobileDevice } from '../functions/browser-detect';\n\nclass TextCanvas extends Component {\n  state = {\n    isMobile: isMobileDevice(),\n    width: window.innerWidth,\n    height: window.innerHeight,\n    dpi: 2,\n    words: [\n      '장수영',\n      '나는',\n      '베라이존',\n      '트라이넷',\n      '카르티에',\n      '마르케',\n      '오디세이',\n      '이것저것',\n      '다음',\n    ],\n    size: {\n      max: 25,\n      grid: 23,\n      min: 21,\n    },\n    fontSize: '140vh',\n    fontFamily: 'Black Han Sans',\n    i: 0,\n    vertical: false,\n    timer: null,\n    wordTimer: null,\n  };\n\n  init = () => {\n    this.canvas = document.getElementById('canvas');\n    this.ctx = this.canvas.getContext('2d');\n\n    this.txtCanv = document.createElement('canvas');\n    this.txtCtx = this.txtCanv.getContext('2d');\n    this.txtCtx.fillStyle = 'black';\n  };\n\n  setValues = () => {\n    this.canvas.width = this.state.width * this.state.dpi;\n    this.canvas.height = this.state.height * this.state.dpi;\n\n    this.particles = [];\n\n    this.txtCanv.width = this.canvas.width;\n    this.txtCanv.height = this.canvas.height;\n    this.txtCtx.textBaseline = 'middle';\n    this.txtCtx.font = `${this.state.fontSize} ${this.state.fontFamily}`;\n\n    if (!this.state.vertical) {\n      this.getPixels(this.state.words[this.state.i]);\n    } else {\n      this.getPixelsV(this.state.words[this.state.i]);\n    }\n\n    this.makeParticles();\n    this.animate();\n  };\n\n  makeParticles = () => {\n    for (let i = 0; i < this.positions.length; i++) {\n      if (!!this.positions[i]) {\n        this.particles.push(\n          new Particle(\n            this.state.width,\n            Math.pow(i, 1.3) * Math.sin(i),\n            this.positions[i].x,\n            this.positions[i].y,\n            this.ctx,\n            this.state.size.min\n          )\n        );\n      }\n    }\n  };\n\n  addParticles = () => {\n    const nta = this.positions.length - this.particles.length;\n    for (let i = 0; i <= nta; i++) {\n      this.particles.push(\n        new Particle(\n          this.canvas.width / 2,\n          i + this.canvas.height / 2,\n          this.canvas.width / 2,\n          i + this.canvas.height / 2,\n          this.ctx,\n          this.state.size.min\n        )\n      );\n    }\n  };\n\n  removeParticles = () => {\n    const newArr = this.particles.slice(0, this.positions.length);\n    this.particles = newArr;\n  };\n\n  getPixels = (keyword) => {\n    this.txtCtx.clearRect(0, 0, this.txtCanv.width, this.txtCanv.height);\n    this.txtCtx.fillText(\n      keyword,\n      this.txtCanv.width / 2 - this.txtCtx.measureText(keyword).width / 2,\n      this.txtCanv.height / 2\n    );\n\n    const imgData = this.txtCtx.getImageData(0, 0, this.txtCanv.width, this.txtCanv.height);\n    const buffer32 = new Uint32Array(imgData.data.buffer);\n\n    this.positions = [];\n    for (let y = 0; y < this.txtCanv.height; y += this.state.size.grid) {\n      for (let x = 0; x < this.txtCanv.width; x += this.state.size.grid) {\n        if (buffer32[y * this.txtCanv.width + x]) {\n          this.positions.push({ x, y });\n        }\n      }\n    }\n\n    const diff =\n      (this.canvas.height - this.positions[this.positions.length - 1].y - this.positions[0].y) / 2;\n    this.positions.forEach((p) => {\n      p.y += diff;\n    });\n  };\n\n  getPixelsV = (keyword) => {\n    this.txtCtx.clearRect(0, 0, this.txtCanv.width, this.txtCanv.height);\n    this.txtCtx.textBaseline = 'top';\n\n    let p;\n    if (keyword.length >= 3) {\n      this.setState(\n        {\n          fontSize: `${(110 / keyword.length) * this.state.dpi}vh`,\n        },\n        () => {\n          this.txtCtx.font = `${this.state.fontSize} ${this.state.fontFamily}`;\n        }\n      );\n      p = 1 / keyword.length;\n    } else {\n      this.setState(\n        {\n          fontSize: `${(80 / keyword.length) * this.state.dpi}vh`,\n        },\n        () => {\n          this.txtCtx.font = `${this.state.fontSize} ${this.state.fontFamily}`;\n        }\n      );\n      p = 0.4;\n    }\n\n    for (let i = 0; i < keyword.length; i++) {\n      this.txtCtx.fillText(\n        keyword[i],\n        i *\n          (this.txtCanv.width / ((keyword.length + 1) / 2) -\n            this.txtCtx.measureText(keyword[i]).width / 2),\n        i * (this.txtCanv.height * p)\n      );\n    }\n\n    const imgData = this.txtCtx.getImageData(0, 0, this.txtCanv.width, this.txtCanv.height);\n    const buffer32 = new Uint32Array(imgData.data.buffer);\n\n    this.positions = [];\n    for (let y = 0; y < this.txtCanv.height; y += this.state.size.grid) {\n      for (let x = 0; x < this.txtCanv.width; x += this.state.size.grid) {\n        if (buffer32[y * this.txtCanv.width + x]) {\n          this.positions.push({ x, y });\n        }\n      }\n    }\n\n    let diff;\n    if (keyword.length >= 3) {\n      diff = this.positions[0].y / -1;\n    } else {\n      diff =\n        (this.canvas.height - this.positions[this.positions.length - 1].y - this.positions[0].y) /\n        2;\n    }\n    this.positions.forEach((p) => {\n      p.y += diff;\n    });\n  };\n\n  animateParticles = () => {\n    this.positions.forEach((p, i) => {\n      this.particles[i].move(this.mx, this.my);\n      this.particles[i].draw();\n    });\n  };\n\n  changeWord = () => {\n    TweenMax.killAll(true);\n\n    if (!this.state.vertical) {\n      this.getPixels(this.state.words[this.state.i]);\n    } else {\n      this.getPixelsV(this.state.words[this.state.i]);\n    }\n\n    if (this.positions.length > this.particles.length) {\n      this.addParticles();\n    } else {\n      this.removeParticles();\n    }\n\n    this.positions.forEach((p, i) => {\n      this.particles[i].homeX = p.x;\n      this.particles[i].homeY = p.y;\n    });\n\n    this.setState({\n      wordTimer: setTimeout(this.tweenSize, 2000),\n    });\n    // this.tweenSize();\n  };\n\n  animate = debounce(() => {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.animateParticles();\n    this.animation = requestAnimationFrame(this.animate);\n  }, 1000 / 60);\n\n  tweenSize = () => {\n    if (this.state.isMobile) return;\n\n    const t = 3.5,\n      l = this.particles.length;\n    this.particles.forEach((p, i) => {\n      TweenMax.to(p, t, {\n        radius: this.state.size.max,\n        homeX: !this.state.isMobile ? p.getX() + 20 : p.getX() + 10,\n        homeY: !this.state.isMobile ? p.getY() + 30 : p.getY() + 15,\n        delay: (t / l) * i,\n        yoyo: true,\n        repeat: -1,\n        easing: Sine.easeInOut,\n      });\n    });\n  };\n\n  resetTween = () => {\n    this.setValues();\n    TweenMax.killAll(true);\n    this.tweenSize();\n  };\n\n  onMouseMove = (e) => {\n    this.mx = (e.clientX - this.canvas.offsetLeft) * this.state.dpi;\n    this.my = (e.clientY - this.canvas.offsetTop) * this.state.dpi;\n  };\n\n  // Reset Canvas State on resize\n  onResize = () => {\n    if (\n      this.state.width !== window.innerWidth ||\n      (this.state.height !== window.innerHeight && this.state.width > 768)\n    ) {\n      this.setCanvasState();\n    }\n  };\n\n  // Canvas State Set Function\n  // Breakpoint sizing updates\n  setCanvasState = () => {\n    this.setState(\n      {\n        width: window.innerWidth,\n        height: window.innerHeight,\n      },\n      () => {\n        if (this.state.width >= 1600) {\n          this.setState(\n            {\n              size: {\n                max: 14.5 * this.state.dpi,\n                grid: 14 * this.state.dpi,\n                min: 13.5 * this.state.dpi,\n              },\n              fontSize: `${70 * this.state.dpi}vh`,\n              vertical: false,\n            },\n            this.setValues\n          );\n        } else if (this.state.width < 1600 && this.state.width >= 1080) {\n          this.setState(\n            {\n              size: {\n                max: 12 * this.state.dpi,\n                grid: 11.5 * this.state.dpi,\n                min: 11 * this.state.dpi,\n              },\n              fontSize: `${65 * this.state.dpi}vh`,\n              vertical: false,\n            },\n            this.setValues\n          );\n        } else if (this.state.width < 1080 && this.state.width >= 768) {\n          this.setState(\n            {\n              size: {\n                max: 9.5 * this.state.dpi,\n                grid: 9 * this.state.dpi,\n                min: 8.5 * this.state.dpi,\n              },\n              fontSize: `${60 * this.state.dpi}vh`,\n              vertical: false,\n            },\n            this.setValues\n          );\n        } else if (this.state.width < 768 && this.state.width >= 480) {\n          this.setState(\n            {\n              size: {\n                max: 7.5 * this.state.dpi,\n                grid: 7 * this.state.dpi,\n                min: 6.5 * this.state.dpi,\n              },\n              fontSize: `${60 * this.state.dpi}vh`,\n              vertical: false,\n            },\n            this.setValues\n          );\n        } else {\n          this.setState(\n            {\n              size: {\n                max: 7.5 * this.state.dpi,\n                grid: 7 * this.state.dpi,\n                min: 6.5 * this.state.dpi,\n              },\n              fontSize: `${40 * this.state.dpi}vh`,\n              vertical: true,\n            },\n            this.setValues\n          );\n        }\n      }\n    );\n  };\n\n  onScroll = () => {\n    TweenMax.killAll(true);\n    this.props.setHasBackground(true);\n    clearTimeout(this.state.wordTimer);\n    clearTimeout(this.state.timer);\n\n    this.setState({\n      timer: setTimeout(() => {\n        this.props.setHasBackground(false);\n        this.tweenSize();\n      }, 5000),\n    });\n  };\n\n  onScrollToBottom = () => {\n    this.updateWord(6, 0);\n  };\n\n  onScrollUp = () => {\n    this.updateCanvas(this.props.location, 0);\n  };\n\n  initWord = () => {\n    switch (this.props.location) {\n      default:\n      case '/':\n        this.setState({ i: 0 });\n        break;\n      case '/about':\n        this.setState({ i: 1 });\n        break;\n      case '/verizon':\n        this.setState({ i: 2 });\n        break;\n      case 'trinet':\n        this.setState({ i: 3 });\n        break;\n      case 'cartier':\n        this.setState({ i: 4 });\n        break;\n      case '/marquee-sports':\n        this.setState({ i: 5 });\n        break;\n      case '/odyssey':\n        this.setState({ i: 6 });\n        break;\n      case '/etc':\n        this.setState({ i: 7 });\n        break;\n    }\n  };\n\n  updateWord = (i, t) => {\n    this.setState({ i }, () => {\n      this.props.getBgText(this.state.words[this.state.i]);\n      setTimeout(() => {\n        this.changeWord();\n      }, t);\n    });\n  };\n\n  updateCanvas = (location, t) => {\n    switch (location) {\n      default:\n      case '/':\n        this.updateWord(0, t);\n        break;\n      case '/about':\n        this.updateWord(1, t);\n        break;\n      case '/verizon':\n        this.updateWord(2, t);\n        break;\n      case 'trinet':\n        this.updateWord(3, t);\n        break;\n      case 'cartier':\n        this.updateWord(4, t);\n        break;\n      case '/marquee-sports':\n        this.updateWord(5, t);\n        break;\n      case '/odyssey':\n        this.updateWord(6, t);\n        break;\n      case '/etc':\n        this.updateWord(7, t);\n        break;\n    }\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.location !== this.props.location) {\n      this.updateCanvas(this.props.location, 250);\n    }\n  }\n\n  componentDidMount() {\n    this.init();\n    this.initWord();\n\n    setTimeout(() => {\n      this.updateCanvas(this.props.location);\n      this.setCanvasState();\n    }, 1500);\n\n    window.addEventListener('resize', debounce(this.onResize, 1000 / 5));\n\n    if (!this.state.isMobile) {\n      window.addEventListener('mousemove', this.onMouseMove);\n      window.addEventListener('scroll', debounce(this.onScroll, 1000 / 45));\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"canvas\">\n        <div\n          style={{\n            fontFamily: 'Black Han Sans',\n            fontSize: '1px',\n            color: '#EFEFEF',\n          }}>\n          장수영 나는 마르케 오디세이 트렁크 이것저것 다음\n        </div>\n        <canvas\n          id=\"canvas\"\n          className=\"shared__canvas\">\n          {this.state.words[this.state.i]}\n        </canvas>\n      </div>\n    );\n  }\n}\n\nexport default TextCanvas;\n"]},"metadata":{},"sourceType":"module"}